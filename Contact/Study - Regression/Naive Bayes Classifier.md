본 글은 공돌이의 수학정리노트님의 포스팅을 공부한 과정을 담았습니다.
https://angeloyeo.github.io/2020/08/04/naive_bayes.html
---

# Step1. 내가 이해하기 쉬운 방향의 스토리텔링

## 어떠한 집단이 있다

그리고 여자와 남자가 있고

이 집단에서 키가 175cm인 사람이 성별이 남자인지 여자인지 맞추어보라고 한다면

우리는 확률적으로 알 수 밖에 없다

그리고 키에 대한 확률밀도함수가 우리에게 주어져있다고 생각한다.

![[Pasted image 20240814125648.jpg]]

우리는 이제 남자쪽에 키가 175cm일 확률이 높기때문에 당연히 확률상 남자라고 생각할 수 있다.

하지만 여기서 놓친 것이 있다.

어떠한 집단의 남자와 여자의 분포가 어떻게 되는지를 고려하지 않았다는 것이다

예를 들어 100명의 집단에서 남자가 1명, 여자는99명이라고 한다면

우리는 저 확률상 175cm이 남자일 가능성이 더 높다고 생각할 수 있는가? 아니다

그래서 우리는 어떠한 데이터에서 미리 알고 있는 지식 사전지식이 중요해진다.

지금의 예시에서는 사전지식은 집단에 대한 성별의 비율에 대한 데이터이다.

우리는 남자일 확률과 여자일 확률을 고려해서 결정해야한다.

그러므로

$$
P(남자)*P(키:175cm~|~남자) \\ P(여자)*P(키:175cm~|~여자)
$$

이 두가지 중 더 높은 확률로 175cm인 사람의 성별을 결정해야 한다.

간단하게는 남자일 확률(사전정보)x주어진 키가 남자일 확률(새로운 정보)

로 결정한다는 것이다.

이 말은 즉 데이터가 많아지고 추가 될수록 그 확률에 대한 결과는 계속 변한다고 볼 수 있다. 

## 정보가 더 추가된다면?

방금 위의 예시에서 몸무게에 대한 정보를 얻는다고 생각해보자

몸무게에 대한 정보와 몸무게에 대한 남녀에 대한 확률밀도함수가 주어졌다고 가정하면

$$
P(남자)*P(키:175cm~|~남자)*P(몸무게 : 80kg~|~남자) \\ P(여자)*P(키:175cm~|~여자)*P(몸무게 : 80kg~|~여자)
$$

로 볼 수 있다.

물론 이 경우에 몸무게에 대한 정보는, 키의 정보에 영향을 주지 않는다는 가정이 필요하다.

아래에 더 설명을 통하여 더 자세히 알 수 있다.

---

# Step2. 베이즈 정리를 통해 예시를 풀기

지금까지 예시에서 목적을 생각해본다면

 키와 몸무게가 이런 사람이

남자일까 여자일까?를 맞추는 것이 목적이었다

### 즉, 원하는 것은 이 데이터를 봤을 때 이 데이터가 어떤 클래스에 속하는지 판단하는 것

위의 예시에서

클래스 : 남자, 여자

데이터 : 키, 몸무게에 대한 정보

그 판단 근거는 확률로부터 얻을 수 있다.

이제 클래스만 주어졌을 때 클래스에 대한 우리가 알고 있는 정보를

사전지식 이라고 한다면 베이지안 이론에 대입해서 생각해볼 수 있다 

$$
P(c_i|x)\\i=1:남자\\i=2:여자\\x:키:175cm~(주어진~데이터)
$$

위의 글을 보았을 때

P(c1|x)는 키가 175cm인 사람이 남자일 확률을 의미한다.

P(c2|x)는 키가 175cm인 사람이 여자일 확률을 의미한다.

그리고 두개의 확률을 비교해서 우리는 더 높은 확률로

남자인지 여자인지를 결정할 수 있다. 

즉 키가 175cm인 사람(데이터)이 남자, 여자 중 어디에 속하는지(클래스)를 결정할 수 있다.

결국 목적은 확률의 비교를 통해 이 데이터의 클래스를 결정한다는 의미이다.

- 공부
- 연구
- 학습법
- 아이디어 구현

우리가 배운 베이지안 정리를 사용한다면

$$
P(c_1|x)=\frac{P(c_1)P(x|c_1)}{P(x)} \\ P(c_2|x)=\frac{P(c_2)P(x|c_2)}{P(x)}\\P(x)는~같으므로\\P(c_1|x)= P(c_1)P(x|c_1) \\P(c_2|x)=P(c_2)P(x|c_2)
$$

위의 공식과 비교한다면

c1: 남자 c2: 여자 x는 키가 175이므로

$$
P(남자)*P(키:175cm~|~남자)\\ P(여자)*P(키:175cm~|~여자)
$$

위의 베이지안 공식으로 보인 것이 스토리텔링 으로써 풀어낸 것과 같은 것을 확인 할 수 있다.

---

# What if? 데이터의 feature가 하나가 아닐 경우?

여러개의 feature를 가지고 class를 판단한다는 의미는 즉

여러개의 데이터를 모두 고려했을 때 이 데이터들을 모두 만족하는 것이 어디 클래스에 속하는지 결정한다는 것이고

클래스가 위의 남녀 예시처럼 두 가지만 있다고 했을 때는

데이터 x가 n개 주어진다고 한다면

 

$$
P(c_1|x_1,x_2,...~,x_n)=P(c_1)*P(x_1|c_1)*P(x_2|c_1,x_1)*P(x_3|c_1,x_1,x_2)*P(x_n|c_1,x_1,x_2,...,x_{n-1}) 
$$

- 위의 공식에 대한 나의 뇌피셜
    
    이 공식이 처음에 가장 와닿지 않았다
    
    P(x2|c1,x1)의 의미는 무엇일까
    
    c1이며 x1를 만족하는 집단이라고 생각해야하나?
    
    말로 풀어서 쓴다면 기존의 클래스 중 
    
    그 클래스가 c1일 확률P(c1) 
    
    c1의 클래스가 x1일 확률 P(x1|c1)
    
    c1의 클래스와 x1인 것인 집단이 x2일 확률인가?
    
    에 대한 나의 생각
    
    몸무게에 대한 예시와 비교를 통하여 생각해보았다
    
    # 정보가 더 추가된다면?
    
    방금 위의 예시에서 몸무게에 대한 정보를 얻는다고 생각해보자
    
    몸무게에 대한 정보와 몸무게에 대한 남녀에 대한 확률밀도함수가 주어졌다고 가정하면
    
    $$
    P(남자)*P(키:175cm~|~남자)*P(몸무게 : 80kg~|~남자) \\ P(여자)*P(키:175cm~|~여자)*P(몸무게 : 80kg~|~여자)
    $$
    
    로 볼 수 있다.
    
    하지만 우리의 확률에 대한 사고의 흐름은
    
    키가 175인 사람이 남자일 확률 = 남자일 확률*남자중에 키가 175일 확률 
    
    키가 175, 몸무게 80이 남자일 확률 = 남자일 확률*남자중에 키가 175일 확률*키가 175인 남자가 몸무게 80일 확률
    
    을 통하여 점점 집합이 작아진다.
    
    조건이 추가될수록 다음 조건에 의한 확률은 제한이 된다는 말이다.
    
    그리고 그 조건을 배제할 수 있는 것이 독립적으로 추출된다는 가정이다.
    

문제가 복잡해지는 이유는 서로의 데이터가 서로의 데이터의 발생여부에 영향을 주기 때문이다.

하지만 각 데이터가 독립적으로 추출된다고 가정한다면

서로의 데이터가 서로에게 영향을 주지 못한다.

그렇기 때문에

$$
P(c_1|x_1,x_2,⋯,x_n)=P(c_1)P(x_1|c_1)P(x_2|c_1)P(x_3|c_1)⋯P(x_n|c1)=P(c_1)\prod_{i=1}^{n}P(x_i|c_1)
$$

라고 표현할 수 있고 우리는 데이터를 통해 클래스를 판단할 때

$$
y=argmax_{k∈(1,2,⋯,k)}P(c_k)\prod_{i=1}^{n} =P(x_i|c_k) \\y:predicted~class
$$

라고 표현할 수 있다.